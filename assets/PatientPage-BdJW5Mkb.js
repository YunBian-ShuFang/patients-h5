import{_ as M}from"./CpRadioBtn-BxP_pk5t.js";import{_ as G}from"./CpIcon-BEJBC59c.js";import{_ as H}from"./CpNavBar-DJXLKEri.js";import{d as J,r as _,a as P,k as K,s as O,b as i,c as n,p as f,h as l,F as Q,i as W,w as u,n as X,t as C,f as h,j as Y,u as x,o as s,v as Z,_ as ee}from"./index-DxsiHbDK.js";import{a as ae,e as te,b as ne,d as oe}from"./user-DgDgPz6X.js";import{F as le,n as se,i as ie}from"./rules-B7gIrbZd.js";import{P as ue,s as B,a as de}from"./request-uc666yY3.js";import{F as re}from"./index-CsAhKhnm.js";import{C as pe}from"./index-YrVuF1XM.js";import{A as ce,a as me}from"./index-HEDfruI8.js";import{B as ve}from"./index-CAQ9J4A5.js";import{s as $}from"./function-call-cRy0kGF_.js";import{u as _e}from"./consult-B3nWt7bb.js";import"./use-placeholder-DGGdHVxQ.js";import"./index-CWA1siCg.js";import"./interceptor-CO5Y9v1H.js";import"./index-C4bX3Bk5.js";import"./use-route-BFOmu3it.js";import"./use-id-Dtm_qled.js";const fe={class:"patient-page"},ge={key:0,class:"patient-change"},ke={class:"patient-list"},Ce=["onClick"],be={class:"info"},ye={class:"name"},we={class:"id"},Ve=["onClick"],Fe={key:0,class:"tag"},Pe={key:1,class:"patient-next"},he=J({__name:"PatientPage",setup(xe){const d=_(!1),w=o=>{if(o){const{id:e,name:c,idCard:k,defaultFlag:y,gender:m}=o;a.value={id:e,name:c,idCard:k,defaultFlag:y,gender:m}}else a.value={...V};d.value=!0},U=[{label:"男",value:1},{label:"女",value:0}],V={name:"",idCard:"",gender:1,defaultFlag:0},a=_({...V}),F=P({get(){return a.value.defaultFlag===1},set(o){a.value.defaultFlag=o?1:0}}),g=_(),N=async()=>{var e;await((e=g==null?void 0:g.value)==null?void 0:e.validate()),+a.value.idCard.slice(-2,-1)%2!==a.value.gender&&await $({title:"温馨提示！",message:`填写的性别和身份证号中的不一致
您确认提交吗？`}),a.value.id?await te(a.value):await ne(a.value),d.value=!1,b(),B(a.value.id?"编辑成功":"添加成功")},R=async()=>{a.value.id&&(await $({title:"温馨提示！",message:`您确认要删除 ${a.value.name} 患者信息吗 ？`}),await oe(a.value.id),b(),d.value=!1,B("删除成功"))},r=_([]),b=async()=>{const o=await ae();if(console.log(o),r.value=o.data,v.value&&r.value.length){const e=r.value.find(c=>c.defaultFlag===1);e?p.value=e.id:p.value=r.value[0].id}};K(async()=>{b()});const S=O(),v=P(()=>S.query.isChange==="1"),p=_(),A=o=>{v.value&&(p.value=o.id)},L=async()=>{if(!p.value)return de("请选择就诊患者");_e().setPatient(p.value),Z.push("/consult/pay")};return(o,e)=>{const c=H,k=G,y=ve,m=re,T=M,z=pe,D=le,I=ce,j=me,q=ue;return s(),i("div",fe,[n(c,{title:v.value?"选择患者":"家庭档案"},null,8,["title"]),v.value?(s(),i("div",ge,e[6]||(e[6]=[l("h3",null,"请选择患者信息",-1),l("p",null,"以便医生给出更准确的治疗，信息仅医生可见",-1)]))):f("",!0),l("div",ke,[(s(!0),i(Q,null,W(r.value,t=>(s(),i("div",{class:X(["patient-item",{selected:p.value===t.id}]),key:t.id,onClick:E=>A(t)},[l("div",be,[l("span",ye,C(t.name),1),l("span",we,C(t.idCard.replace(/^(.{6}).+(.{4})$/,"$1********$2")),1),l("span",null,C(t.genderValue),1),l("span",null,C(t.age)+"岁",1)]),l("div",{class:"icon",onClick:E=>w(t)},[n(k,{name:"user-edit"})],8,Ve),t.defaultFlag===1?(s(),i("div",Fe,"默认")):f("",!0)],10,Ce))),128)),r.value.length<6?(s(),i("div",{key:0,class:"patient-add",onClick:e[0]||(e[0]=t=>w())},[n(k,{name:"user-add"}),e[7]||(e[7]=l("p",null,"添加患者",-1))])):f("",!0),e[9]||(e[9]=l("div",{class:"patient-tip"},"最多可添加6人",-1)),v.value?(s(),i("div",Pe,[n(y,{type:"primary",round:"",block:"",onClick:L},{default:u(()=>e[8]||(e[8]=[h("下一步")])),_:1})])):f("",!0)]),n(q,{show:d.value,"onUpdate:show":e[5]||(e[5]=t=>d.value=t),position:"right"},{default:u(()=>[n(c,{back:()=>d.value=!1,title:a.value.id?"编辑患者":"添加患者","right-text":"保存",onClickRight:N},null,8,["back","title"]),n(D,{accesskey:"off",ref_key:"form",ref:g},{default:u(()=>[n(m,{label:"真实姓名",placeholder:"请输入真实姓名",modelValue:a.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.name=t),rules:x(se)},null,8,["modelValue","rules"]),n(m,{label:"身份证号",placeholder:"请输入身份证号",modelValue:a.value.idCard,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.idCard=t),rules:x(ie)},null,8,["modelValue","rules"]),n(m,{label:"性别",class:"pb4"},{input:u(()=>[n(T,{options:U,modelValue:a.value.gender,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.gender=t)},null,8,["modelValue"])]),_:1}),n(m,{label:"默认就诊人"},{input:u(()=>[n(z,{modelValue:F.value,"onUpdate:modelValue":e[4]||(e[4]=t=>F.value=t),"icon-size":18,round:""},null,8,["modelValue"])]),_:1})]),_:1},512),a.value.id?(s(),Y(j,{key:0},{default:u(()=>[n(I,{onClick:R},{default:u(()=>e[10]||(e[10]=[h("删除")])),_:1})]),_:1})):f("",!0)]),_:1},8,["show"])])}}}),Ke=ee(he,[["__scopeId","data-v-242fe26c"]]);export{Ke as default};
