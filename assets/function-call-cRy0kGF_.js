import{p as F,P as H,b as R,m as K,u as I}from"./request-uc666yY3.js";import{d as U,r as L,A as p,B as z,c as o,m as S}from"./index-DxsiHbDK.js";import{B as k}from"./index-CAQ9J4A5.js";import{A as P,a as M}from"./index-HEDfruI8.js";import{e as m,c as W,d as T,p as j,f as q,t as w,h as V,j as G,n as J,k as Q,l as X,o as Y,q as Z}from"./index-CWA1siCg.js";import{c as $}from"./interceptor-CO5Y9v1H.js";const[ee,a,f]=W("dialog"),te=m({},R,{title:String,theme:String,width:J,message:[String,Function],callback:Function,allowHtml:Boolean,className:G,transition:V("van-dialog-bounce"),messageAlign:String,closeOnPopstate:w,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:w,closeOnClickOverlay:Boolean,keyboardEnabled:w}),ne=[...F,"transition","closeOnPopstate"];var oe=U({name:ee,props:te,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:r,slots:l}){const u=L(),i=p({confirm:!1,cancel:!1}),b=t=>r("update:show",t),y=t=>{var n;b(!1),(n=e.callback)==null||n.call(e,t)},v=t=>()=>{e.show&&(r(t),e.beforeClose?(i[t]=!0,$(e.beforeClose,{args:[t],done(){y(t),i[t]=!1},canceled(){i[t]=!1}})):y(t))},B=v("cancel"),g=v("confirm"),x=z(t=>{var n,c;if(!e.keyboardEnabled||t.target!==((c=(n=u.value)==null?void 0:n.popupRef)==null?void 0:c.value))return;({Enter:e.showConfirmButton?g:T,Escape:e.showCancelButton?B:T})[t.key](),r("keydown",t)},["enter","esc"]),D=()=>{const t=l.title?l.title():e.title;if(t)return o("div",{class:a("header",{isolated:!e.message&&!l.default})},[t])},O=t=>{const{message:n,allowHtml:c,messageAlign:s}=e,d=a("message",{"has-title":t,[s]:s}),h=Q(n)?n():n;return c&&typeof h=="string"?o("div",{class:d,innerHTML:h},null):o("div",{class:d},[h])},E=()=>{if(l.default)return o("div",{class:a("content")},[l.default()]);const{title:t,message:n,allowHtml:c}=e;if(n){const s=!!(t||l.title);return o("div",{key:c?1:0,class:a("content",{isolated:!s})},[O(s)])}},A=()=>o("div",{class:[Y,a("footer")]},[e.showCancelButton&&o(k,{size:"large",text:e.cancelButtonText||f("cancel"),class:a("cancel"),style:{color:e.cancelButtonColor},loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(k,{size:"large",text:e.confirmButtonText||f("confirm"),class:[a("confirm"),{[X]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]),N=()=>o(M,{class:a("footer")},{default:()=>[e.showCancelButton&&o(P,{type:"warning",text:e.cancelButtonText||f("cancel"),class:a("cancel"),color:e.cancelButtonColor,loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(P,{type:"danger",text:e.confirmButtonText||f("confirm"),class:a("confirm"),color:e.confirmButtonColor,loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]}),_=()=>l.footer?l.footer():e.theme==="round-button"?N():A();return()=>{const{width:t,title:n,theme:c,message:s,className:d}=e;return o(H,S({ref:u,role:"dialog",class:[a([c]),d],style:{width:q(t)},tabindex:0,"aria-labelledby":n||s,onKeydown:x,"onUpdate:show":b},j(e,ne)),{default:()=>[D(),E(),_()]})}}});let C;const le={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let ae=m({},le);function ce(){({instance:C}=K({setup(){const{state:r,toggle:l}=I();return()=>o(oe,S(r,{"onUpdate:show":l}),null)}}))}function se(e){return Z?new Promise((r,l)=>{C||ce(),C.open(m({},ae,e,{callback:u=>{(u==="confirm"?r:l)(u)}}))}):Promise.resolve(void 0)}const Be=e=>se(m({showCancelButton:!0},e));export{se as a,oe as b,Be as s};
